<!DOCTYPE html>
<html>
<head>
    <title>Video Hub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Ads ‡∂Ω‡∑É‡∑ä‡∑É‡∂±‡∂ß ‡∂∏‡∑ê‡∂Ø‡∂ß ‡∂ú‡∂±‡∑ä‡∂± ‡∑É‡∑Ñ ‡∂¥‡∂ª‡∂≠‡∂ª‡∂∫‡∂ö‡∑ä ‡∂≠‡∑í‡∂∫‡∂±‡∑ä‡∂± ‡∂Ø‡∑è‡∂¥‡∑î ‡∂Ö‡∂Ω‡∑î‡∂≠‡∑ä Styles */
        .ad-wrapper {
            text-align: center;
            margin: 20px auto;
            padding: 10px;
            max-width: 100%;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
    </style>
</head>
<body>

<header>
    <div class="logo">Video Hub</div>
    <a href="admin.html" class="nav-btn">üîí Admin</a>
</header>

<!-- ================= TOP AD (‡∂ã‡∂© ‡∂≠‡∑í‡∂∫‡∑ô‡∂± Ad ‡∂ë‡∂ö) ================= -->
<div class="ad-wrapper">
    <script async="async" data-cfasync="false" src="https://pl28499138.effectivegatecpm.com/ab156ca71ac330f95a6cd68d1ae74514/invoke.js"></script>
    <div id="container-ab156ca71ac330f95a6cd68d1ae74514"></div>
</div>
<!-- ============================================================= -->

<div class="container">
    <div class="grid" id="videoGrid">
        <p style="text-align:center; color:#555; width:100%;">Loading Videos...</p>
    </div>
</div>

<!-- ================= BOTTOM AD (‡∂Ö‡∂Ω‡∑î‡∂≠‡∑í‡∂±‡∑ä ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∑Ö Ad ‡∂ë‡∂ö) ================= -->
<!-- ‡∂ã‡∂© Ad ‡∂ë‡∂ö‡∂∏ ‡∂∏‡∑ô‡∂≠‡∂± ‡∂±‡∑ê‡∑Ä‡∂≠ ‡∂¥‡∑è‡∑Ä‡∑í‡∂†‡∑ä‡∂†‡∑í ‡∂ö‡∂ª ‡∂á‡∂≠. -->
<div class="ad-wrapper">
    <script async="async" data-cfasync="false" src="https://pl28499138.effectivegatecpm.com/ab156ca71ac330f95a6cd68d1ae74514/invoke.js"></script>
    <div id="container-ab156ca71ac330f95a6cd68d1ae74514"></div>
</div>
<!-- ==================================================================== -->

<!-- Pop-under Script (‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂±‡∑ú‡∂ö‡∂ª ‡∂≠‡∑í‡∂∂‡∑ñ ‡∂¥‡∂ª‡∂Ø‡∑í‡∂∏) -->
<script src="https://pl28499562.effectivegatecpm.com/7b/83/ec/7b83ec01fdc23f6d448e5d2ab9400560.js"></script>

<script>
    // --- Google Sheet CSV Link ‡∂ë‡∂ö ---
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTDHMCsnKxbAdBApU5e1Jqw65HhPP_ti_TczWjyhMC-emufORz2D6MvWNrVk77KqF7so5OPhIR8YGkz/pub?output=csv";
    // -----------------------------

    async function loadVideos() {
        const grid = document.getElementById('videoGrid');
        try {
            const res = await fetch(sheetURL);
            const text = await res.text();
            const rows = text.split('\n').slice(1);
            
            grid.innerHTML = '';

            rows.reverse().forEach(row => {
                // Regex ‡∂¥‡∑è‡∑Ä‡∑í‡∂†‡∑ä‡∂†‡∑í ‡∂ö‡∂ª‡∂Ω‡∑è Data ‡∑Ä‡∑ô‡∂±‡∑ä ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂±‡∑Ä‡∑è
                const matches = row.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
                if(!matches || matches.length < 3) return;

                // Cleanup quotes
                const title = matches[1]?.replace(/^"|"$/g, '');
                const category = matches[2]?.replace(/^"|"$/g, '');
                const url = matches[3]?.replace(/^"|"$/g, '').trim();

                if(title && url && url.startsWith('http')) {
                    
                    const encodedUrl = encodeURIComponent(url);
                    const encodedTitle = encodeURIComponent(title);

                    const card = `
                        <div class="video-card">
                            <a href="watch.html?v=${encodedUrl}&t=${encodedTitle}" style="text-decoration:none; color:white;">
                                <div class="video-player" style="background:#000; display:flex; align-items:center; justify-content:center; position:relative;">
                                    <video src="${url}#t=1" style="width:100%; height:100%; object-fit:cover;" preload="metadata"></video>
                                    <div style="position:absolute; font-size:40px; color:white; text-shadow:0 0 10px black;">‚ñ∂</div>
                                </div>
                                <div class="info">
                                    <span class="cat">${category}</span>
                                    <div class="title">${title}</div>
                                </div>
                            </a>
                        </div>
                    `;
                    grid.innerHTML += card;
                }
            });

        } catch (err) {
            console.error(err);
            grid.innerHTML = '<p style="text-align:center;">Error loading videos.</p>';
        }
    }
    
    loadVideos();
</script>

</body>
</html>